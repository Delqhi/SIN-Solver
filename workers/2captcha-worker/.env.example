################################################################################
# 2Captcha Worker - Environment Configuration
# 
# Copy this file to .env and fill in your actual values
# Never commit .env to git - it contains sensitive information
#
# Generated: 2026-01-30
# Version: 1.0.0
################################################################################

################################################################################
# API SERVER CONFIGURATION
################################################################################

# Port on which the REST API server listens
# Default: 8019
PORT=8019

# Node.js environment
# Values: development, production, test
# Default: development
NODE_ENV=development

################################################################################
# WORKER CONFIGURATION
################################################################################

# Maximum number of concurrent worker processes
# Higher values = more parallelism, more resource usage
# Recommended: 3-10 (depends on CPU cores and memory)
# Default: 5
MAX_WORKERS=5

# Maximum size of the job queue
# Jobs beyond this limit will be rejected
# Default: 1000
MAX_QUEUE_SIZE=1000

# Default timeout for job execution (in milliseconds)
# Jobs taking longer will be terminated
# Default: 60000 (60 seconds)
DEFAULT_TIMEOUT_MS=60000

# Timeout for CAPTCHA detection phase (in milliseconds)
# How long to wait for CAPTCHA to appear and be detected
# Default: 120000 (2 minutes)
DETECTOR_TIMEOUT_MS=120000

# Timeout for API requests (in milliseconds)
# HTTP requests taking longer will timeout
# Default: 30000 (30 seconds)
REQUEST_TIMEOUT_MS=30000

################################################################################
# RETRY CONFIGURATION
################################################################################

# Maximum number of retry attempts for failed jobs
# Set to 0 to disable retries
# Default: 3
MAX_RETRIES=3

# Base delay between retries (in milliseconds)
# Actual delay = RETRY_BACKOFF_MS * (attempt_number ^ 2) for exponential backoff
# Default: 1000 (1 second)
RETRY_BACKOFF_MS=1000

################################################################################
# BROWSER CONFIGURATION
################################################################################

# Run browser in headless mode (no UI)
# Values: true, false
# Default: true (recommended for production)
# Set to false for debugging/visual monitoring
HEADLESS=true

# Enable stealth mode to avoid detection
# Disables navigator.webdriver and other detection vectors
# Values: true, false
# Default: true (STRONGLY RECOMMENDED for 2Captcha work)
STEALTH_MODE=true

################################################################################
# ANTI-BAN SYSTEM CONFIGURATION
################################################################################

# Enable anti-ban protection mechanisms
# Includes work hour limits, rate limiting, session management
# Values: true, false
# Default: true
ANTI_BAN_ENABLED=true

# Anti-ban pattern strategy
# Values: 
#   - normal: Standard work pattern (balanced)
#   - aggressive: Rapid job processing (higher ban risk)
#   - conservative: Slow, careful work (lowest ban risk)
# Default: normal
ANTI_BAN_PATTERN=normal

# Work hours start (24-hour format)
# Jobs will be paused after WORK_HOURS_END
# Default: 8 (8:00 AM)
WORK_HOURS_START=8

# Work hours end (24-hour format)
# Jobs will resume after WORK_HOURS_START next day
# Default: 22 (10:00 PM)
WORK_HOURS_END=22

# Enable verbose anti-ban logging
# Logs all anti-ban decisions and triggers
# Values: true, false
# Default: false
VERBOSE_ANTI_BAN=false

################################################################################
# VISION/AI MODEL CONFIGURATION
################################################################################

# Vision AI provider for CAPTCHA recognition
# Values: opencode, opencode-zen, gemini, mistral, skyvern, local-yolo
# Default: opencode
VISION_PROVIDER=opencode

# Vision AI model identifier
# Examples:
#   - opencode: gemini-3-flash
#   - gemini: gemini-2.0-flash
#   - mistral: pixtral-large
#   - skyvern: vision-api
#   - local-yolo: yolov8-captcha
# Default: (depends on provider)
VISION_MODEL=gemini-3-flash

# Vision AI timeout (in milliseconds)
# How long to wait for AI model to recognize CAPTCHA
# Default: 30000 (30 seconds)
VISION_TIMEOUT=30000

# Alternative timeout format (legacy)
VISION_TIMEOUT_MS=30000

# Confidence threshold for vision recognition (0.0-1.0)
# Results below this threshold are rejected
# Default: 0.85
VISION_CONFIDENCE_THRESHOLD=0.85

################################################################################
# AI MODEL API KEYS & ENDPOINTS
################################################################################

# OpenCode AI API key
# Get from: https://api.opencode.ai
# Format: Bearer token or API key
OPENCODE_API_KEY=

# OpenCode ZEN API key (FREE, uncensored AI)
# Get from: https://api.opencode.ai/zen
# No cost, no rate limits for personal use
OPENCODE_ZEN_API_KEY=

# Google Gemini API key
# Get from: https://ai.google.dev/
# Free tier available with usage limits
GEMINI_API_URL=https://generativelanguage.googleapis.com
VISION_API_KEY=

# Mistral AI API key
# Get from: https://console.mistral.ai
# Requires paid account for production use
MISTRAL_API_KEY=
MISTRAL_API_URL=https://api.mistral.ai

# Skyvern API key (visual automation)
# Get from: https://skyvern.com
# For advanced visual understanding
SKYVERN_API_KEY=
SKYVERN_API_URL=https://api.skyvern.com

################################################################################
# LOGGING CONFIGURATION
################################################################################

# Log level for console output
# Values: debug, info, warn, error, silent
# Default: info
LOG_LEVEL=info

# Enable verbose logging
# Logs additional debug information
# Values: true, false
# Default: false
VERBOSE_LOGGING=false

################################################################################
# ALERTING & NOTIFICATIONS
################################################################################

# Slack webhook URL for alerts
# Get from: https://api.slack.com/messaging/webhooks
# Optional - leave blank to disable Slack notifications
SLACK_WEBHOOK_URL=

# Telegram bot token for alerts
# Get from: https://t.me/BotFather
# Optional - leave blank to disable Telegram notifications
TELEGRAM_BOT_TOKEN=

# Telegram chat ID to send alerts to
# How to find: Send message to @userinfobot and use the result
# Optional - only used if TELEGRAM_BOT_TOKEN is set
TELEGRAM_CHAT_ID=

################################################################################
# ALERT THRESHOLDS & CONFIGURATION
################################################################################

# Warning threshold for accuracy drops
# Triggers alert if accuracy falls below this percentage (0-100)
# Default: 75
ALERT_ACCURACY_WARNING_THRESHOLD=75

# Emergency stop threshold for accuracy
# Automatically stops worker if accuracy falls below this (0-100)
# Set to 0 to disable emergency stops
# Default: 50
ALERT_EMERGENCY_STOP_THRESHOLD=50

# Rate limit alert frequency (in seconds)
# How often to check and alert about rate limiting
# Default: 300 (5 minutes)
ALERT_RATE_LIMIT_SECONDS=300

################################################################################
# ADVANCED CONFIGURATION
################################################################################

# Solver API port (if running solver service)
# Used for communication with other services
# Default: 8019
SOLVER_API_PORT=8019

################################################################################
# NOTES
################################################################################

# 1. SECURITY
#    - Never commit .env to git
#    - Use strong, unique API keys
#    - Rotate keys regularly
#    - Don't share .env with untrusted parties

# 2. PERFORMANCE TUNING
#    - MAX_WORKERS: Higher = faster but more resource-intensive
#    - DETECTOR_TIMEOUT_MS: Longer = more patient, more timeouts
#    - REQUEST_TIMEOUT_MS: Balance between reliability and responsiveness

# 3. ANTI-BAN BEST PRACTICES
#    - Use conservative pattern if getting rate limited
#    - Enable work hours to spread jobs across different times
#    - Monitor accuracy and adjust VISION_CONFIDENCE_THRESHOLD

# 4. VISION MODEL SELECTION
#    - opencode-zen: FREE, fast, good for standard CAPTCHAs
#    - gemini-3-flash: Good accuracy, reasonable cost
#    - mistral: Fast, good for complex CAPTCHAs
#    - local-yolo: No API calls, but requires local YOLO model

# 5. DEBUGGING
#    - Set LOG_LEVEL=debug for detailed debugging
#    - Set HEADLESS=false to see browser interactions
#    - Set VERBOSE_ANTI_BAN=true to see anti-ban decisions
#    - Check logs directory for full application logs

# 6. PRODUCTION DEPLOYMENT
#    - Always set HEADLESS=true
#    - Keep STEALTH_MODE=true
#    - Use ANTI_BAN_PATTERN=normal or conservative
#    - Monitor ALERT_* thresholds and adjust as needed
#    - Set up proper logging to file or aggregation service
