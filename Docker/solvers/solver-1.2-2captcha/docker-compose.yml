services:
  solver-1.2-2captcha-worker:
    build:
      context: ../../../workers/2captcha-worker
      dockerfile: Dockerfile
    container_name: solver-1.2-2captcha-worker
    ports:
      - "52002:3000"
    environment:
      - NODE_ENV=production
      - ACCOUNT_ID=account-2
      - ACCOUNT_NAME=Gina
      - ACCOUNT_EMAIL=${ACCOUNT_2_EMAIL}
      - ACCOUNT_PASSWORD=${ACCOUNT_2_PASSWORD}
      - DAILY_LIMIT=1000
      - MAX_CONCURRENT=1
      - STEEL_CDP_URL=ws://agent-05-steel-browser:9222
      - STEEL_HTTP_URL=http://agent-05-steel-browser:3000
      - SKYVERN_URL=http://agent-06-skyvern-solver:8000
      - OLLAMA_URL=http://host.docker.internal:11434
      - MISTRAL_API_KEY=${MISTRAL_API_KEY}
      - GROQ_API_KEY=${GROQ_API_KEY_2}
      - REDIS_URL=redis://room-04-redis-cache:6379/2
    networks:
      - sin-solver-network
    volumes:
      - solver-1.2-data:/app/data
      - solver-1.2-screenshots:/app/screenshots
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    labels:
      - "com.sin-solver.service=solver"
      - "com.sin-solver.solver-number=1.2"
      - "com.sin-solver.account=Gina"

volumes:
  solver-1.2-data:
    driver: local
  solver-1.2-screenshots:
    driver: local

networks:
  sin-solver-network:
    external: true
    name: sin-solver-network
