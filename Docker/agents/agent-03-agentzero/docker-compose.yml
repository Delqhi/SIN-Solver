
services:
  agent-03-agentzero-coder:
    image: frdel/agent-zero:latest
    container_name: agent-03-agentzero-coder
    ports:
      - "8050:8000"
    environment:
      - NODE_ENV=production
      - OPENCODE_API_KEY=${OPENCODE_API_KEY}
      - OPENCODE_BASE_URL=${OPENCODE_BASE_URL:-https://api.opencode.ai/v1}
      - DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@room-03-postgres-master:5432/${DB_NAME}
      - REDIS_URL=redis://room-04-redis-cache:6379
      - LOG_LEVEL=${LOG_LEVEL:-info}
      - AGENT_NAME=agent-03-agentzero
      - AGENT_ID=03
      - AGENT_ROLE=code-generation
      - AGENT_VERSION=1.0.0
      - MAX_WORKERS=${AGENT_03_MAX_WORKERS:-4}
      - MEMORY_LIMIT=${AGENT_03_MEMORY_LIMIT:-4gb}
    networks:
      - sin-solver-network
    volumes:
      - agent-03-cache:/home/agent-zero/.cache
      - agent-03-data:/home/agent-zero/data
      - /var/run/docker.sock:/var/run/docker.sock
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 120s
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
        labels: "service=agent-03-agentzero"
    labels:
      - "com.sin-solver.service=agent"
      - "com.sin-solver.agent-number=03"
      - "com.sin-solver.agent-role=code-generation"
      - "com.sin-solver.version=1.0"

volumes:
  agent-03-cache:
    driver: local
  agent-03-data:
    driver: local

networks:
  sin-solver-network:
    external: true
    name: sin-solver-network
